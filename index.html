<!doctype html>
<html ng-app>
  <head>
    <script src="angular.min.js"></script>
    <script src="riffwave.js"></script>
    <script src="underscore.js"></script>
    <script type="text/javascript"
            src="http://www.parsecdn.com/js/parse-1.1.5.min.js"></script>
    <script src="controllers.js"></script>
    <link rel="stylesheet" type="text/css" href="bootstrap.css" />
    <style type="text/css">
      table {
          border-spacing: 0px;
      }
      .note {
          width:10px;
          height:6px;
      }
      .noPlay {
          background-color:cadetblue;
      }
      .play {
          background-color:coral;
      }
    </style>
  </head>
  <body ng-controller="ParseGlobal">
    <h1>BANJITZU</h1>
    <div ng-controller="Authentication"
         ng-show="!currentUser">
      <div>
        <input type="text" ng-model="register.username" />
        <input type="password" ng-model="register.password" />
        <input type="email" ng-model="register.email" />
        <button ng-click="register()">Register</button>
      </div>
      <div>
        <input type="text" ng-model="login.username" />
        <input type="password" ng-model="login.password" />
        <button ng-click="login()">Login</button>
      </div>
    </div>
    
    <div ng-controller="Editor"
         ng-show="currentUser">
      
      <div class="row">
        <div class="span3 offset9">
          <h4>Hello {{ currentUser.attributes.username }}</h4>
          <button ng-click="logout()">Logout</button>
        </div>
      </div>
      
      <div class="row">
        
        <div class="span4">
          <h3>Sequences</h3>
          <ul>
            <li ng-repeat="sequence in sequences">
              <a ng-controller="LibrarySequence"
                 ng-click="load()">
                {{ sequence.attributes.name }}
              </a>
            </li>
          </ul>
        </div>
        
        <div class="span8">
          
          <h4>{{openSequence.name}}</h4>
          
          <button ng-disabled="task" ng-click="start()">Start</button>
          <button ng-disabled="!task" ng-click="stop()">Stop</button>
          <button ng-click="saveAsNew()">Save As New</button>
          <input type="text" 
                 class="input-small"
                 ng-model="newSequence.name" />
          
          <table>
            <!-- a pitch is a row of note cells -->
            <tr ng-repeat="pitch in currentSequence.editData">
              <!-- a note cell is the actual button -->
              <td ng-repeat="notecell in pitch">
                <div ng-controller="NoteCell" 
                     class="note"
                     ng-class="playClass" 
                     ng-click="toggle()" 
                     ng-style="notecell.style" />
              </td>
            </tr>
          </table>
          
        </div>
      </div>
    </div>
  </body>
</html>
